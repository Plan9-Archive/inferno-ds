<../../../mkconfig

CONF=sds				#default configuration
SYSTARG=$OSTARG
OBJTYPE=arm #thumb

<$ROOT/mkfiles/mkfile-$SYSTARG-$OBJTYPE	#set vars based on target system

KTZERO7=0x03800000
KDZERO7=$KTZERO7

OFILES=\
	l.$O\
	div.$O\
	main.$O\
	ipc.$O\
	spi.$O\
	clock.$O\
	system.$O\
	serial.$O\
	touch.$O\
	microphone.$O\
	interrupts.$O\
	userSettings.$O\

HFILES=\
	../mem.h\
	nds.h\
	jtypes.h\
	bios.h\
	card.h\
	dma.h\
	interrupts.h\
	ipc.h\
	memory.h\
	system.h\
	serial.h\
	timers.h\
	audio.h\
	clock.h\
	touch.h\
	wifi.h\

LIBS=\
	kern\

CFLAGS=-wFV -I $ROOT/Inferno/arm/include -I $ROOT/include -r

default:V: i$CONF i$CONF.p9

i$CONF: $OFILES
	$LD -o $target -H4 -R0 -T$KTZERO7 -D$KDZERO7 -l $OFILES $libs $SYSLIBS
i$CONF.p9: $OFILES
	$LD -o $target -R0 -T$KTZERO7 -D$KDZERO7 -l $OFILES $libs $SYSLIBS
	ksize $target

syms:   $OFILES
	$CC $CFLAGS -a '-DKERNDATE='$KERNDATE defaultARM7.c >syms

vclean:V: clean
	rm -f syms
	rm -f i$CONF i$CONF.p9

<$ROOT/mkfiles/mkone-$SHELLTYPE
